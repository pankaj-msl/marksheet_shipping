import{k as R,l as q,p as z,P as D,q as g,o as l,f as a,a as n,b as e,d as r,w as b,u as _,y as U,F as y,x as f,t as p,g as v,e as E,n as F,G as I,B as M,C as O}from"./app-D1mwo86F.js";import P from"./Header-DSwLys8E.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w=x=>(M("data-v-5de55121"),x=x(),O(),x),G=w(()=>e("div",null,null,-1)),H={id:"main",class:"main"},J=w(()=>e("div",{class:"pagetitle"},[e("h1",null,"Students Document Shipments")],-1)),K={class:"section"},Q={class:"mt-8 flex flex-col"},W={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},X={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},Y={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg relative mx-1"},Z={class:"min-w-full divide-y divide-gray-300"},ee=w(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Roll No "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Name "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Email "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Pendings "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Shipped "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Delivered "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Shipment Tracking "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Report ")])],-1)),te={class:"divide-y divide-gray-200 bg-white"},se={key:0},oe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 text-secondary sm:pl-6"},le={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},ae={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-warning"},ne={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},ie={key:0,style:{"list-style-type":"none"}},re={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},ce={key:0,style:{"list-style-type":"none"}},de={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},pe={key:0,style:{"list-style-type":"none"}},me={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},_e=["onClick"],xe={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},he=["onClick"],ue={key:0,class:"max-w-7xl mx-auto py-6"},ye={class:"max-w-none mx-auto"},ge={class:"bg-white overflow-hidden shadow sm:rounded-lg"},fe={class:"bg-white px-4 py-3 flex items-center justify-between"},ve=w(()=>e("div",{class:"flex-1 flex justify-between sm:hidden"},null,-1)),be={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},we={class:"text-sm text-gray-700 text-primary"},ke={class:"font-medium"},Ce={class:"font-medium"},Se={class:"font-medium"},Te=["onClick","disabled"],Re=["innerHTML"],Ne={__name:"Shipments",props:{client:{type:Object,required:!0},admin:{type:Object,required:!0}},setup(x){let h=R(""),m=R({}),k=null,C=R(1);const S=q();z(h,s=>{console.log("Search query changed:",s),C.value=1,k&&clearTimeout(k),k=setTimeout(()=>{T()},500)});const N=s=>{C.value=s.url.split("=")[1],T()},T=()=>{axios.get("/shipments/view",{params:{query:h.value,page:C.value}}).then(s=>{console.log(s),m.value=s.data.students}).catch(s=>{console.error(s.message),S.error(s.message)})},j=s=>{I.visit(`/shipment/student/${s}`)},B=s=>{axios.get(`/shipments/generate-report/${s}`,{responseType:"blob"}).then(i=>{const c=window.URL.createObjectURL(new Blob([i.data])),d=document.createElement("a");d.href=c,d.setAttribute("download",`shipments_student_${s}.xlsx`),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d)}).catch(i=>{console.error(i.message),S.error(i.message)})},L=()=>{axios.get("/shipments/download",{responseType:"blob"}).then(s=>{const i=window.URL.createObjectURL(new Blob([s.data])),c=document.createElement("a");c.href=i,c.setAttribute("download","all_shipments.xlsx"),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)}).catch(s=>{console.error(s.message),S.error(s.message)})};return D(()=>{T()}),(s,i)=>{const c=g("v-text-field"),d=g("v-col"),V=g("v-btn"),$=g("v-row"),u=g("v-icon");return l(),a(y,null,[G,n(P,{data:{client:x.client,admin:x.admin}},null,8,["data"]),e("main",H,[J,e("section",K,[r(" Shipment Tracking "),n($,{class:"d-flex justify-space-between"},{default:b(()=>[n(d,{cols:"12",md:"6"},{default:b(()=>[n(c,{modelValue:_(h),"onUpdate:modelValue":i[0]||(i[0]=t=>U(h)?h.value=t:h=t),label:"Search by name, roll number or email ...","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":""},null,8,["modelValue"])]),_:1}),n(d,{cols:"12",md:"3",offset:"3",class:"d-flex align-self-center"},{default:b(()=>[n(V,{class:"ooey-gooey text-white",onClick:i[1]||(i[1]=t=>L())},{default:b(()=>[r("Download Shipment Report")]),_:1})]),_:1})]),_:1}),e("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("table",Z,[ee,(l(!0),a(y,null,f(_(m).data,t=>(l(),a("tbody",te,[t.documents.length>0?(l(),a("tr",se,[e("td",oe,p(t.student_roll_no),1),e("td",le,[n(u,{icon:"mdi-account"}),r(" "+p(t.student_name),1)]),e("td",ae,[n(u,{icon:t.email?"mdi-email":""},null,8,["icon"]),r(" "+p(t.email),1)]),e("td",ne,[(l(!0),a(y,null,f(t.documents,o=>(l(),a("span",null,[o!=null&&o.shipment_id?v("",!0):(l(),a("li",ie,[n(u,{size:"medium",color:"red-darken-4",icon:"mdi-knob",class:"mx-1"}),r(p(o.document_name),1)]))]))),256))]),e("td",re,[(l(!0),a(y,null,f(t.documents,o=>(l(),a("span",null,[o!=null&&o.shipment_id&&o.shipment.delivery_status=="shipped"?(l(),a("li",ce,[n(u,{size:"medium",color:"warning",icon:"mdi-truck",class:"mx-1"}),r(p(o.document_name),1)])):v("",!0)]))),256))]),e("td",de,[(l(!0),a(y,null,f(t.documents,o=>(l(),a("span",null,[o!=null&&o.shipment_id&&o.shipment.delivery_status=="delivered"?(l(),a("li",pe,[n(u,{size:"medium",color:"green-darken-2",icon:"mdi-check-decagram",class:"mx-1"}),r(p(o.document_name),1)])):v("",!0)]))),256))]),e("td",me,[e("button",{class:"text-success",onClick:o=>j(t.id)}," Track Shipment ",8,_e),n(u,{icon:"mdi-truck",color:"primary",class:"mx-1"})]),e("td",xe,[e("button",{class:"text-primary",onClick:o=>B(t.id)}," Generate Report ",8,he)])])):v("",!0)]))),256))])])])])]),_(m).current_page?(l(),a("div",ue,[e("div",ye,[e("div",ge,[e("div",fe,[ve,e("div",be,[e("div",null,[e("p",we,[r(" Showing "),e("span",ke,p(_(m).from),1),r(" to "),e("span",Ce,p(_(m).to),1),r(" of "),e("span",Se,p(_(m).total),1),r(" results ")])]),e("div",null,[(l(!0),a(y,null,f(_(m).links,(t,o)=>(l(),a("button",{onClick:E(je=>N(t),["prevent"]),key:o,disabled:t.active||!t.url,class:F(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",{"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":t.active,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":!t.active}])},[e("span",{innerHTML:t.label,class:"text-primary"},null,8,Re)],10,Te))),128))])])])])])])):v("",!0)])])],64)}}},$e=A(Ne,[["__scopeId","data-v-5de55121"]]);export{$e as default};
