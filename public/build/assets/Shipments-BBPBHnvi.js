import{k,l as z,p as D,P as O,q as w,o as a,f as l,a as n,b as e,d as r,w as C,u as m,y as U,g as x,F as g,x as b,t as _,e as E,n as F,G as I,B as M,C as P}from"./app-B0RD5qJU.js";import A from"./Header-BREM8Kaf.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const f=h=>(M("data-v-48e472e0"),h=h(),P(),h),H=f(()=>e("div",null,null,-1)),J={id:"main",class:"main"},K=f(()=>e("div",{class:"pagetitle"},[e("h1",null,"Students Document Shipments")],-1)),Q={class:"section"},W={class:"mt-8 flex flex-col"},X={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},Y={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},Z={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg relative mx-1"},ee={class:"min-w-full divide-y divide-gray-300"},te=f(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Roll No "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Name "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Email "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Pendings "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Shipped "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Delivered "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Shipment Tracking "),e("th",{scope:"col",class:"py-3.5 pl-1 pr-1 text-left text-sm text-primary font-semibold text-gray-900 sm:pl-6"}," Report ")])],-1)),se={key:0,class:"divide-y divide-gray-200 bg-white"},oe={key:0},ae=f(()=>e("td",{class:"text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500",colspan:7}," Loading students data please wait ... ",-1)),le=[ae],ne={key:1},ie=f(()=>e("td",{class:"text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500",colspan:7}," Oops no students data available ",-1)),re=[ie],ce={class:"divide-y divide-gray-200 bg-white"},de={key:0},pe={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 text-secondary sm:pl-6"},me={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},_e={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-warning"},xe={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},he={key:0,style:{"list-style-type":"none"}},ue={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},ye={key:0,style:{"list-style-type":"none"}},ge={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-primary"},fe={key:0,style:{"list-style-type":"none"}},ve={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},we=["onClick"],be={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},ke=["onClick"],Ce={key:0,class:"max-w-7xl mx-auto py-6"},Se={class:"max-w-none mx-auto"},Te={class:"bg-white overflow-hidden shadow sm:rounded-lg"},Re={class:"bg-white px-4 py-3 flex items-center justify-between"},Ne=f(()=>e("div",{class:"flex-1 flex justify-between sm:hidden"},null,-1)),je={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Le={class:"text-sm text-gray-700 text-primary"},Be={class:"font-medium"},Ve={class:"font-medium"},$e={class:"font-medium"},qe=["onClick","disabled"],ze=["innerHTML"],De={__name:"Shipments",props:{client:{type:Object,required:!0},admin:{type:Object,required:!0}},setup(h){let u=k(""),d=k({}),S=null,T=k(1);const R=z(),v=k(!1);D(u,s=>{console.log("Search query changed:",s),T.value=1,S&&clearTimeout(S),S=setTimeout(()=>{N()},500)});const j=s=>{T.value=s.url.split("=")[1],N()},N=()=>{v.value=!0,axios.get("/shipments/view",{params:{query:u.value,page:T.value}}).then(s=>{console.log(s),v.value=!1,d.value=s.data.students}).catch(s=>{console.error(s.message),v.value=!1,R.error(s.message)})},L=s=>{I.visit(`/shipment/student/${s}`)},B=s=>{axios.get(`/shipments/generate-report/${s}`,{responseType:"blob"}).then(i=>{const c=window.URL.createObjectURL(new Blob([i.data])),p=document.createElement("a");p.href=c,p.setAttribute("download",`shipments_student_${s}.xlsx`),document.body.appendChild(p),p.click(),p.parentNode.removeChild(p)}).catch(i=>{console.error(i.message),R.error(i.message)})},V=()=>{axios.get("/shipments/download",{responseType:"blob"}).then(s=>{const i=window.URL.createObjectURL(new Blob([s.data])),c=document.createElement("a");c.href=i,c.setAttribute("download","all_shipments.xlsx"),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)}).catch(s=>{console.error(s.message),R.error(s.message)})};return O(()=>{N()}),(s,i)=>{const c=w("v-text-field"),p=w("v-col"),$=w("v-btn"),q=w("v-row"),y=w("v-icon");return a(),l(g,null,[H,n(A,{data:{client:h.client,admin:h.admin}},null,8,["data"]),e("main",J,[K,e("section",Q,[r(" Shipment Tracking "),n(q,{class:"d-flex justify-space-between"},{default:C(()=>[n(p,{cols:"12",md:"6"},{default:C(()=>[n(c,{modelValue:m(u),"onUpdate:modelValue":i[0]||(i[0]=t=>U(u)?u.value=t:u=t),label:"Search by name, roll number or email ...","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":""},null,8,["modelValue"])]),_:1}),n(p,{cols:"12",md:"3",offset:"3",class:"d-flex align-self-center"},{default:C(()=>[n($,{class:"ooey-gooey text-white",onClick:i[1]||(i[1]=t=>V())},{default:C(()=>[r("Download Shipment Report")]),_:1})]),_:1})]),_:1}),e("div",W,[e("div",X,[e("div",Y,[e("div",Z,[e("table",ee,[te,v.value||m(d).data.length===0?(a(),l("tbody",se,[v.value?(a(),l("tr",oe,le)):x("",!0),m(d).data.length===0?(a(),l("tr",ne,re)):x("",!0)])):x("",!0),(a(!0),l(g,null,b(m(d).data,t=>(a(),l("tbody",ce,[t.documents.length>0?(a(),l("tr",de,[e("td",pe,_(t.student_roll_no),1),e("td",me,[n(y,{icon:"mdi-account"}),r(" "+_(t.student_name),1)]),e("td",_e,[n(y,{icon:t.email?"mdi-email":""},null,8,["icon"]),r(" "+_(t.email),1)]),e("td",xe,[(a(!0),l(g,null,b(t.documents,o=>(a(),l("span",null,[o!=null&&o.shipment_id?x("",!0):(a(),l("li",he,[n(y,{size:"medium",color:"red-darken-4",icon:"mdi-knob",class:"mx-1"}),r(_(o.document_name),1)]))]))),256))]),e("td",ue,[(a(!0),l(g,null,b(t.documents,o=>(a(),l("span",null,[o!=null&&o.shipment_id&&o.shipment.delivery_status=="shipped"?(a(),l("li",ye,[n(y,{size:"medium",color:"warning",icon:"mdi-truck",class:"mx-1"}),r(_(o.document_name),1)])):x("",!0)]))),256))]),e("td",ge,[(a(!0),l(g,null,b(t.documents,o=>(a(),l("span",null,[o!=null&&o.shipment_id&&o.shipment.delivery_status=="delivered"?(a(),l("li",fe,[n(y,{size:"medium",color:"green-darken-2",icon:"mdi-check-decagram",class:"mx-1"}),r(_(o.document_name),1)])):x("",!0)]))),256))]),e("td",ve,[e("button",{class:"text-success",onClick:o=>L(t.id)}," Track Shipment ",8,we),n(y,{icon:"mdi-truck",color:"primary",class:"mx-1"})]),e("td",be,[e("button",{class:"text-primary",onClick:o=>B(t.id)}," Generate Report ",8,ke)])])):x("",!0)]))),256))])])])])]),m(d).current_page?(a(),l("div",Ce,[e("div",Se,[e("div",Te,[e("div",Re,[Ne,e("div",je,[e("div",null,[e("p",Le,[r(" Showing "),e("span",Be,_(m(d).from),1),r(" to "),e("span",Ve,_(m(d).to),1),r(" of "),e("span",$e,_(m(d).total),1),r(" results ")])]),e("div",null,[(a(!0),l(g,null,b(m(d).links,(t,o)=>(a(),l("button",{onClick:E(Oe=>j(t),["prevent"]),key:o,disabled:t.active||!t.url,class:F(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",{"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":t.active,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":!t.active}])},[e("span",{innerHTML:t.label,class:"text-primary"},null,8,ze)],10,qe))),128))])])])])])])):x("",!0)])])],64)}}},Ie=G(De,[["__scopeId","data-v-48e472e0"]]);export{Ie as default};
